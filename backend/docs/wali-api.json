{
    "openapi": "3.1.0",
    "info": {
        "title": "Wali API",
        "description": "Dokumentasi endpoint Wali",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost:8080"
        }
    ],
    "paths": {
        "/api/wali": {
            "get": {
                "description": "Listing wali (paginasi, optional search by nama)",
                "parameters": [
                    {
                        "name": "Authorization",
                        "in": "header",
                        "description": "User token dari database",
                        "schema": {
                            "type": "string",
                            "examples": [
                                "eyJ..."
                            ]
                        }
                    },
                    {
                        "name": "per_page",
                        "in": "query",
                        "description": "Jumlah item per halaman (default 30)",
                        "schema": {
                            "type": "integer",
                            "minimum": 1,
                            "default": 30
                        }
                    },
                    {
                        "name": "search",
                        "in": "query",
                        "description": "Filter nama mengandung kata kunci",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Berhasil mengambil data wali",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Wali"
                                            }
                                        },
                                        "links": {
                                            "type": "object"
                                        },
                                        "meta": {
                                            "type": "object"
                                        }
                                    }
                                },
                                "examples": {
                                    "tanpa search": {
                                        "description": "Mengambil data tanpa search",
                                        "value": {
                                            "data": [
                                                {
                                                    "id": 317,
                                                    "nama": "Mr. Alexys Emmerich",
                                                    "jenis_kelamin": "Laki-laki",
                                                    "agama": "islam",
                                                    "pendidikan_terakhir": "SD",
                                                    "pekerjaan": "Refrigeration Mechanic",
                                                    "alamat": "352 Lura Mills Apt. 706\nLurlinemouth, IL 88748-4262",
                                                    "no_hp": "509.343.1049",
                                                    "keterangan": "A exercitationem alias rerum commodi. Unde autem blanditiis soluta accusantium nam. Ut aliquid quidem vel."
                                                },
                                                {
                                                    "id": 318,
                                                    "nama": "Mr. Stephon Cummerata",
                                                    "jenis_kelamin": "Perempuan",
                                                    "agama": "islam",
                                                    "pendidikan_terakhir": "S1",
                                                    "pekerjaan": "Mathematician",
                                                    "alamat": "1795 Marquardt Ridges\nNorth Cathrine, TX 78591-8017",
                                                    "no_hp": "531-479-0114",
                                                    "keterangan": "Laborum harum officiis ipsa facilis fugiat veritatis. Aut facilis dolor qui enim sint."
                                                },
                                                {
                                                    "id": 319,
                                                    "nama": "Ms. Kelli Murray MD",
                                                    "jenis_kelamin": "Laki-laki",
                                                    "agama": "islam",
                                                    "pendidikan_terakhir": "D3",
                                                    "pekerjaan": "Personal Financial Advisor",
                                                    "alamat": "42245 Gorczany Cape\nMoenside, AL 29491",
                                                    "no_hp": "1-848-638-4244",
                                                    "keterangan": "In totam corporis ad vero voluptas. Et eum delectus animi et labore fugit. Consequatur consequatur sint eius. Occaecati laborum quasi ducimus esse."
                                                }
                                            ],
                                            "links": {
                                                "first": "http://localhost:8000/api/wali?page=1",
                                                "last": "http://localhost:8000/api/wali?page=1",
                                                "prev": null,
                                                "next": null
                                            },
                                            "meta": {
                                                "current_page": 1,
                                                "from": 1,
                                                "last_page": 1,
                                                "links": [
                                                    {
                                                        "url": null,
                                                        "label": "&laquo; Previous",
                                                        "page": null,
                                                        "active": false
                                                    },
                                                    {
                                                        "url": "http://localhost:8000/api/wali?page=1",
                                                        "label": "1",
                                                        "page": 1,
                                                        "active": true
                                                    },
                                                    {
                                                        "url": null,
                                                        "label": "Next &raquo;",
                                                        "page": null,
                                                        "active": false
                                                    }
                                                ],
                                                "path": "http://localhost:8000/api/wali",
                                                "per_page": 30,
                                                "to": 3,
                                                "total": 3
                                            }
                                        }
                                    },
                                    "dengan search": {
                                        "description": "Mengambil data dengan search",
                                        "value": {
                                            "data": [
                                                {
                                                    "id": 331,
                                                    "nama": "Budi Santoso",
                                                    "jenis_kelamin": "Perempuan",
                                                    "agama": "islam",
                                                    "pendidikan_terakhir": "D3",
                                                    "pekerjaan": "Hand Sewer",
                                                    "alamat": "41348 Dave Inlet Apt. 918\nOsinskifort, IA 24879",
                                                    "no_hp": "615-485-8249",
                                                    "keterangan": "Maiores consequatur eius ut aut deleniti enim ipsum. Unde deleniti consequatur eum blanditiis vel id. Minima quia nihil illum dolores. Omnis est omnis beatae provident."
                                                }
                                            ],
                                            "links": {
                                                "first": "http://localhost:8000/api/wali?page=1",
                                                "last": "http://localhost:8000/api/wali?page=1",
                                                "prev": null,
                                                "next": null
                                            },
                                            "meta": {
                                                "current_page": 1,
                                                "from": 1,
                                                "last_page": 1,
                                                "links": [
                                                    {
                                                        "url": null,
                                                        "label": "&laquo; Previous",
                                                        "page": null,
                                                        "active": false
                                                    },
                                                    {
                                                        "url": "http://localhost:8000/api/wali?page=1",
                                                        "label": "1",
                                                        "page": 1,
                                                        "active": true
                                                    },
                                                    {
                                                        "url": null,
                                                        "label": "Next &raquo;",
                                                        "page": null,
                                                        "active": false
                                                    }
                                                ],
                                                "path": "http://localhost:8000/api/wali",
                                                "per_page": 30,
                                                "to": 1,
                                                "total": 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Login diperlukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "unauthorized": {
                                        "description": "Login diperlukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "unauthorized."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "description": "Tambah data wali baru",
                "parameters": [
                    {
                        "name": "Authorization",
                        "in": "header",
                        "description": "User token dari database",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/WaliCreateRequest"
                            },
                            "examples": {
                                "create": {
                                    "value": {
                                        "nama": "Ayah",
                                        "jenis_kelamin": "Laki-laki",
                                        "agama": "Islam",
                                        "pendidikan_terakhir": "SMA",
                                        "pekerjaan": "Wiraswasta",
                                        "alamat": "Pontianak",
                                        "no_hp": "081122334455",
                                        "keterangan": null
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Success menambah data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/Wali"
                                        }
                                    }
                                },
                                "examples": {
                                    "success": {
                                        "description": "Berhasil membuat data wali",
                                        "value": {
                                            "data": {
                                                "id": 366,
                                                "nama": "Ayah",
                                                "jenis_kelamin": "Laki-laki",
                                                "agama": "Islam",
                                                "pendidikan_terakhir": "SMA",
                                                "pekerjaan": "Wiraswasta",
                                                "alamat": "Pontianak",
                                                "no_hp": "081122334455",
                                                "keterangan": null
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validasi data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ValidationErrorResponse"
                                },
                                "examples": {
                                    "validation error": {
                                        "description": "Validasi Form request",
                                        "value": {
                                            "errors": {
                                                "nama": [
                                                    "The nama field is required."
                                                ],
                                                "jenis_kelamin": [
                                                    "The jenis kelamin field is required."
                                                ],
                                                "agama": [
                                                    "The agama field is required."
                                                ],
                                                "pendidikan_terakhir": [
                                                    "The pendidikan terakhir field is required."
                                                ],
                                                "alamat": [
                                                    "The alamat field is required."
                                                ],
                                                "no_hp": [
                                                    "The no hp field is required."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Login diperlukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "unauthorized": {
                                        "description": "Login diperlukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "unauthorized."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/wali?search={nama}": {
            "get": {
                "deprecated": true,
                "description": "Pencarian wali by nama (deprecated). Gunakan GET /api/wali dengan query 'search'=nama.",
                "parameters": [
                    {
                        "name": "Authorization",
                        "in": "header",
                        "description": "User token dari database",
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "nama",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Search response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Wali"
                                            }
                                        },
                                        "links": {
                                            "type": "object"
                                        },
                                        "meta": {
                                            "type": "object"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Login diperlukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/wali/{id}": {
            "get": {
                "description": "Ambil detail satu wali",
                "parameters": [
                    {
                        "name": "Authorization",
                        "in": "header",
                        "description": "User token dari database",
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID numeric wali",
                        "schema": {
                            "type": "integer",
                            "minimum": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success mendapatkan wali",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/Wali"
                                        }
                                    }
                                },
                                "examples": {
                                    "success": {
                                        "description": "Berhasil mendapatkan data",
                                        "value": {
                                            "data": {
                                                "id": 367,
                                                "nama": "Clement Wyman",
                                                "jenis_kelamin": "Perempuan",
                                                "agama": "islam",
                                                "pendidikan_terakhir": "D2",
                                                "pekerjaan": "Manufactured Building Installer",
                                                "alamat": "193 Abshire Mountain Suite 878\nEast Eryn, MD 91796-7617",
                                                "no_hp": "1-680-698-5465",
                                                "keterangan": "Qui ea ratione natus et aut tenetur. Iusto beatae dolorum ut quia repellendus minima."
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Data wali tidak ditemukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "not found": {
                                        "description": "Data tidak ditemukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "wali tidak ditemukan."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Login diperlukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "unauthorized": {
                                        "description": "Login diperlukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "unauthorized."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "description": "Update penuh data wali (semua field wajib)",
                "parameters": [
                    {
                        "name": "Authorization",
                        "in": "header",
                        "description": "User token dari database",
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "id",
                        "in": "path",
                        "schema": {
                            "type": "integer",
                            "minimum": 1
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/WaliUpdateRequest"
                            },
                            "examples": {
                                "update": {
                                    "value": {
                                        "nama": "Ayah",
                                        "jenis_kelamin": "Laki-laki",
                                        "agama": "Islam",
                                        "pendidikan_terakhir": "SMA",
                                        "pekerjaan": "Wiraswasta",
                                        "alamat": "Pontianak",
                                        "no_hp": "081122334455",
                                        "keterangan": null
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Success update wali",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/Wali"
                                        }
                                    }
                                },
                                "examples": {
                                    "success": {
                                        "description": "Berhasil update data",
                                        "value": {
                                            "data": {
                                                "id": 379,
                                                "nama": "Ayah",
                                                "jenis_kelamin": "Laki-laki",
                                                "agama": "Islam",
                                                "pendidikan_terakhir": "SMA",
                                                "pekerjaan": "Wiraswasta",
                                                "alamat": "Pontianak",
                                                "no_hp": "081122334455",
                                                "keterangan": "Occaecati sint sit eos et alias voluptatibus temporibus. Qui non laudantium beatae eum eveniet expedita. Molestiae dolorum rerum laboriosam eius a alias maiores. Quos maiores optio qui labore."
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Update failed not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "not found": {
                                        "description": "Data yang ingin diupdate tidak ditemukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "wali tidak ditemukan."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validasi data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ValidationErrorResponse"
                                },
                                "examples": {
                                    "validation required": {
                                        "value": {
                                            "errors": {
                                                "nama": [
                                                    "The nama field is required."
                                                ],
                                                "jenis_kelamin": [
                                                    "The jenis kelamin field is required."
                                                ],
                                                "agama": [
                                                    "The agama field is required."
                                                ],
                                                "pendidikan_terakhir": [
                                                    "The pendidikan terakhir field is required."
                                                ],
                                                "alamat": [
                                                    "The alamat field is required."
                                                ],
                                                "no_hp": [
                                                    "The no hp field is required."
                                                ]
                                            }
                                        }
                                    },
                                    "invalid no hp": {
                                        "value": {
                                            "errors": {
                                                "no_hp": [
                                                    "The no hp field format is invalid."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Login diperlukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "unauthorized": {
                                        "description": "Login diperlukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "unauthorized."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "description": "Hapus data wali",
                "parameters": [
                    {
                        "name": "Authorization",
                        "in": "header",
                        "description": "User token dari database",
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "id",
                        "in": "path",
                        "schema": {
                            "type": "integer",
                            "minimum": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success delete wali",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "type": "boolean"
                                        }
                                    }
                                },
                                "examples": {
                                    "success": {
                                        "value": {
                                            "data": true
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Update failed not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "not found": {
                                        "description": "Data yang ingin diupdate tidak ditemukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "wali tidak ditemukan."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Wali digunakan pada data siswa",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "has child row": {
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "wali digunakan pada data siswa."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Login diperlukan",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                },
                                "examples": {
                                    "unauthorized": {
                                        "description": "Login diperlukan",
                                        "value": {
                                            "errors": {
                                                "message": [
                                                    "unauthorized."
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "Wali": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "nama": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "jenis_kelamin": {
                        "type": "string",
                        "enum": [
                            "Laki-laki",
                            "Perempuan"
                        ]
                    },
                    "agama": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "pendidikan_terakhir": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "pekerjaan": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "maxLength": 100
                    },
                    "alamat": {
                        "type": "string"
                    },
                    "no_hp": {
                        "type": "string",
                        "maxLength": 20
                    },
                    "keterangan": {
                        "type": [
                            "string",
                            "null"
                        ]
                    }
                }
            },
            "WaliCreateRequest": {
                "type": "object",
                "required": [
                    "nama",
                    "jenis_kelamin",
                    "agama",
                    "pendidikan_terakhir",
                    "alamat",
                    "no_hp"
                ],
                "properties": {
                    "nama": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "jenis_kelamin": {
                        "type": "string",
                        "enum": [
                            "Laki-laki",
                            "Perempuan"
                        ]
                    },
                    "agama": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "pendidikan_terakhir": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "pekerjaan": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "maxLength": 100
                    },
                    "alamat": {
                        "type": "string"
                    },
                    "no_hp": {
                        "type": "string",
                        "maxLength": 20,
                        "pattern": "^[0-9+\\-\\s]+$"
                    },
                    "keterangan": {
                        "type": [
                            "string",
                            "null"
                        ]
                    }
                }
            },
            "WaliUpdateRequest": {
                "type": "object",
                "required": [
                    "nama",
                    "jenis_kelamin",
                    "agama",
                    "pendidikan_terakhir",
                    "alamat",
                    "no_hp"
                ],
                "properties": {
                    "nama": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "jenis_kelamin": {
                        "type": "string",
                        "enum": [
                            "Laki-laki",
                            "Perempuan"
                        ]
                    },
                    "agama": {
                        "type": "string",
                        "maxLength": 50
                    },
                    "pendidikan_terakhir": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "pekerjaan": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "maxLength": 100
                    },
                    "alamat": {
                        "type": "string"
                    },
                    "no_hp": {
                        "type": "string",
                        "maxLength": 20,
                        "pattern": "^[0-9+\\-\\s]+$"
                    },
                    "keterangan": {
                        "type": [
                            "string",
                            "null"
                        ]
                    }
                }
            },
            "ErrorResponse": {
                "type": "object",
                "properties": {
                    "errors": {
                        "type": "object"
                    }
                }
            },
            "ValidationErrorResponse": {
                "type": "object",
                "properties": {
                    "errors": {
                        "type": "object",
                        "additionalProperties": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        }
    }
}